<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="schedule">

<select id="findToDoList" parameterType="map" resultType="schedulevo">
	<![CDATA[
		select a.no, a.check_date as checkDate, a.schedule_contents as scheduleContents,
				a.type, a.user_no as userNo, a.group_no as groupNo
		from schedule a, user b
		where b.id = #{id}
			and a.check_date = #{date}
			and a.type = 'todo'
			and a.group_no is null
			order by a.no desc
	]]>
</select>


<select id="findRepoList" parameterType="map" resultType="schedulevo">
	<![CDATA[
		select a.no, a.check_date as checkDate, a.schedule_contents as scheduleContents,
				a.type, a.user_no as userNo, a.group_no as groupNo
		from schedule a, user b
			where a.user_no = b.no
			and b.id = #{id}
			and a.check_date = #{date}
			and a.type = 'commit'
			and a.group_no is null
			order by a.no desc
	]]>
</select>

<select id="findNaviCommitList" parameterType="map" resultType="schedulevo">
	<![CDATA[
		select a.no, a.check_date as checkDate
		from schedule a, user b
		where a.user_no = b.no
			and b.id = #{id}
			and a.type = 'commit'
			and a.check_date like '%${date }%'
			and a.group_no is null
            group by a.check_date
			order by a.check_date desc;
	]]>
</select>



<select id="findCheckedToDoDay" parameterType="string" resultType="schedulevo">
	<![CDATA[
		select a.no, count(*), a.check_date as checkDate
			from schedule a, user b
			where a.user_no = b.no
			and b.id = #{id}
			and a.type = 'todo'
			group by a.check_date;
	]]>
</select>

<select id="findCheckedCommitDay" parameterType="string" resultType="schedulevo">
	<![CDATA[
		select a.no, count(*), a.check_date as checkDate
			from schedule a, user b
			where a.user_no = b.no
			and b.id = #{id}
			and a.type = 'commit'
			group by a.check_date;
	]]>
</select>


<insert id="insertToDo" parameterType="schedulevo">
	<![CDATA[
			insert into schedule 
			values(null, #{checkDate},#{scheduleContents},'todo',#{userNo},null)
	]]>
</insert>

<delete id="deleteToDo" parameterType="schedulevo">
		<![CDATA[
			delete from schedule where no=#{no}
		]]>
	</delete>


</mapper>